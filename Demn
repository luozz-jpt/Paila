-- Paila Hub v6 - Abyss [BETA] FIX INF O2 + AUTO FARM by Paila (pro Yoto)
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("Paila Hub v6 - Abyss FIX", "Midnight")

local player = game.Players.LocalPlayer
local rs = game:GetService("ReplicatedStorage")
local tween = game:GetService("TweenService")
local run = game:GetService("RunService")

-- Encontra remotes reais (genÃ©rico pros que mudam)
local remotes = {}
for _, v in pairs(rs:GetDescendants()) do
    if v:IsA("RemoteEvent") and (v.Name:lower():find("fish") or v.Name:lower():find("catch") or v.Name:lower():find("harpoon") or v.Name:lower():find("cast") or v.Name:lower():find("reel") or v.Name:lower():find("sell")) then
        table.insert(remotes, v)
    end
end
local sellRemote = remotes[1] -- primeiro pra sell/catch
print("Remotes encontrados: ", #remotes) -- printa no console pra ver

-- Vars
local autoFarm = false
local infO2 = false
local fishESP = false
local autoSell = false
local autoEquip = false
local noFog = false
local tubeSpeed = 50

-- INF O2 FIX (busca todos paths comuns)
local function infiniteOxygen()
    pcall(function()
        -- Path 1: leaderstats
        if player:FindFirstChild("leaderstats") then
            local oxy = player.leaderstats:FindFirstChild("Oxygen") or player.leaderstats:FindFirstChild("O2")
            if oxy then oxy.Value = math.huge return end
        end
        -- Path 2: direto no player
        local oxy = player:FindFirstChild("Oxygen") or player:FindFirstChild("O2")
        if oxy then oxy.Value = math.huge return end
        -- Path 3: character
        if player.Character then
            local oxy = player.Character:FindFirstChild("Oxygen") or player.Character:FindFirstChild("O2")
            if oxy then oxy.Value = math.huge return end
        end
        -- Path 4: values folder comum em betas
        local values = workspace:FindFirstChild("Values") or rs:FindFirstChild("Values")
        if values then
            local oxy = values:FindFirstChild("Oxygen") or values:FindFirstChild("O2")
            if oxy then oxy.Value = math.huge end
        end
    end)
end

-- AUTO FARM FIX (ativa tool + fire todos fish remotes)
local function autoCatchLoop()
    pcall(function()
        if player.Character and player.Character:FindFirstChildOfClass("Tool") then
            -- Equipa e ativa harpoon
            local tool = player.Character:FindFirstChildOfClass("Tool")
            if tool and tool.Name:lower():find("harpoon") then
                tool:Activate() -- simula throw/cast
                task.wait(0.1)
            end
            -- Fire todos remotes fish
            for _, remote in pairs(remotes) do
                remote:FireServer()
            end
        end
    end)
end

-- ESP (igual, mas limpa velhos)
local function fishESP()
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("Model") and (obj.Name:lower():find("fish") or obj.Name:lower():find("mutant") or obj.Name:lower():find("chest")) and not obj:FindFirstChild("PailaESP") then
            local hl = Instance.new("Highlight")
            hl.Name = "PailaESP"
            hl.Parent = obj
            hl.FillTransparency = 0.3
            hl.OutlineTransparency = 0
            hl.OutlineColor = Color3.new(1,1,1)
            if obj.Name:lower():find("mutant") then hl.FillColor = Color3.new(1,0,0)
            elseif obj.Name:lower():find("legend") or obj.Name:lower():find("chest") then hl.FillColor = Color3.new(1,1,0)
            else hl.FillColor = Color3.new(0,1,0) end
        end
    end
end

local function autoSellReturn()
    pcall(function()
        local stats = player.leaderstats or player
        local weight = stats:FindFirstChild("Weight") or stats:FindFirstChild("InventoryWeight")
        local oxy = stats:FindFirstChild("Oxygen") or stats:FindFirstChild("O2")
        if weight and weight.Value >= 90 then
            for _, remote in pairs(remotes) do remote:FireServer() end -- sell via remotes
            print("Paila vendeu full!")
        end
        if oxy and oxy.Value <= 20 then
            local hrp = player.Character.HumanoidRootPart
            tween:Create(hrp, TweenInfo.new(1.5), {CFrame = CFrame.new(hrp.Position.X, 100, hrp.Position.Z)}):Play()
        end
    end)
end

local function fastTube()
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.WalkSpeed = tubeSpeed
        player.Character.Humanoid.JumpPower = tubeSpeed * 1.5
    end
end

local function equipHarpoon()
    for _, tool in pairs(player.Backpack:GetChildren()) do
        if tool:IsA("Tool") and tool.Name:lower():find("harpoon") then
            tool.Parent = player.Character
            break
        end
    end
end

local function removeFog()
    game.Lighting.FogEnd = math.huge
    game.Lighting.FogStart = math.huge
    if workspace.Terrain then
        workspace.Terrain.FogEnd = math.huge
        workspace.Terrain.FogStart = math.huge
    end
end

-- UI TABS
local FarmTab = Window:NewTab("ðŸ¤¿ Farm FIX")
local FarmSec = FarmTab:NewSection("Autos Fixados")

FarmSec:NewToggle("Auto Farm (FIX Tool + Remotes)", "Agora pega peixe!", function(state)
    autoFarm = state
    spawn(function()
        while autoFarm do
            autoCatchLoop()
            wait(0.1)
        end
    end)
end)

FarmSec:NewToggle("Infinite Oxygen (FIX Paths)", "Busca todos O2!", function(state)
    infO2 = state
    spawn(function()
        while infO2 do
            infiniteOxygen()
            wait(0.1)
        end
    end)
end)

FarmSec:NewToggle("Fish + Chest ESP", "Color raridade", function(state)
    fishESP = state
    spawn(function()
        while fishESP do
            -- Limpa ESP velhos
            for _, obj in pairs(workspace:GetDescendants()) do
                if obj:FindFirstChild("PailaESP") then obj.PailaESP:Destroy() end
            end
            fishESP()
            wait(1)
        end
    end)
end)

FarmSec:NewToggle("Auto Sell + Return Low O2", "Full auto", function(state)
    autoSell = state
    spawn(function()
        while autoSell do
            autoSellReturn()
            wait(1.5)
        end
    end)
end)

FarmSec:NewToggle("Auto Equip Harpoon", "Sempre pronto", function(state)
    autoEquip = state
    spawn(function()
        while autoEquip do
            equipHarpoon()
            wait(1)
        end
    end)
end)

FarmSec:NewSlider("Tube Speed", "Voa no tubo", 500, 16, function(s)
    tubeSpeed = s
end)

local UtilTab = Window:NewTab("âš™ï¸ Util")
local UtilSec = UtilTab:NewSection("Extras")

UtilSec:NewToggle("Remove Fog", "VisÃ£o limpa", function(state)
    noFog = state
    if state then removeFog() end
end)

UtilSec:NewButton("TP Surface AGORA", "Emergency O2", function()
    if player.Character then
        player.Character.HumanoidRootPart.CFrame = CFrame.new(0, 150, 0)
    end
end)

UtilSec:NewButton("Print Remotes (Debug)", "VÃª no console", function()
    for i, v in pairs(remotes) do print(i, v.Name, v.Parent.Name) end
end)

-- LOOP GLOBAL MESTRE
spawn(function()
    while wait(0.5) do
        infiniteOxygen()
        fishESP()
        equipHarpoon()
        if noFog then removeFog() end
        fastTube()
        autoSellReturn()
    end
end)

print("Paila v6 FIX carregado pro Yoto! Inf O2 + Farm agora pegam REMOTES reais. Ativa e testa, clica 'Print Remotes' pra ver nomes no F9!")
