-- Paila Hub v7 ULTIMATE - Abyss [BETA] FULL ESP + FIX FARM/O2 by Paila (pro Yoto)
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("Paila Hub v7 - Abyss ULTIMATE", "Midnight")

local player = game.Players.LocalPlayer
local rs = game:GetService("ReplicatedStorage")
local ts = game:GetService("TeleportService")
local tween = game:GetService("TweenService")
local run = game:GetService("RunService")
local cam = workspace.CurrentCamera

-- Encontra TODOS remotes Ãºteis (fish/harpoon/catch/sell/oxygen)
local remotes = {}
for _, v in pairs(rs:GetDescendants()) do
    if v:IsA("RemoteEvent") and (v.Name:lower():find("fish") or v.Name:lower():find("harpoon") or v.Name:lower():find("throw") or v.Name:lower():find("cast") or v.Name:lower():find("catch") or v.Name:lower():find("reel") or v.Name:lower():find("sell") or v.Name:lower():find("oxygen") or v.Name:lower():find("return")) then
        table.insert(remotes, v)
    end
end
print("Paila v7: Encontrados " .. #remotes .. " remotes fish/harpoon!")

-- Vars
local autoFarm = false
local autoO2 = false  -- TP surface loop
local fullESP = false
local autoSell = false
local autoEquip = false
local noFog = false
local tubeSpeed = 50

-- AUTO O2 FIX: TP surface antes morrer (top scripts usam isso)
local function autoOxygenTP()
    pcall(function()
        local o2Value
        -- Busca O2 em todos paths
        if player.leaderstats then o2Value = player.leaderstats:FindFirstChild("Oxygen") or player.leaderstats:FindFirstChild("O2") end
        if not o2Value then o2Value = player:FindFirstChild("Oxygen") or player:FindFirstChild("O2") end
        if player.Character then o2Value = player.Character:FindFirstChild("Oxygen") or player.Character:FindFirstChild("O2") end
        if o2Value and o2Value.Value <= 25 then
            player.Character.HumanoidRootPart.CFrame = CFrame.new(0, 150, 0)  -- surface TP
            print("Paila TP O2 salva!")
        end
    end)
end

-- AUTO FARM ULTIMATE: Equip + activate + fire remotes
local function autoFarmLoop()
    pcall(function()
        if player.Character then
            local tool = player.Character:FindFirstChildOfClass("Tool")
            if tool and tool.Name:lower():find("harpoon") then
                tool:Activate()  -- throw/cast
                task.wait(0.15)
            end
            -- Fire top 5 remotes (catch/reel/sell)
            for i = 1, math.min(5, #remotes) do
                remotes[i]:FireServer()
            end
        end
    end)
end

-- FULL ESP: Highlight + Billboard name/rarity + Box + distance (OP visual)
local function createFullESP(obj)
    if obj:FindFirstChild("PailaFullESP") then return end
    local espFolder = Instance.new("Folder")
    espFolder.Name = "PailaFullESP"
    espFolder.Parent = obj

    -- Highlight colorido
    local hl = Instance.new("Highlight")
    hl.Name = "HL"
    hl.Parent = espFolder
    hl.FillTransparency = 0.4
    hl.OutlineTransparency = 0
    hl.OutlineColor = Color3.new(1,1,1)

    -- BoxHandleAdornment
    local box = Instance.new("BoxHandleAdornment")
    box.Name = "Box"
    box.Parent = espFolder
    box.Size = obj.Size + Vector3.new(0.5,0.5,0.5)
    box.Color3 = Color3.new(1,0,0)
    box.Transparency = 0.5
    box.ZIndex = 0
    box.AlwaysOnTop = true

    -- BillboardGui name + distance
    local bill = Instance.new("BillboardGui")
    bill.Name = "Bill"
    bill.Parent = espFolder
    bill.Size = UDim2.new(0, 100, 0, 50)
    bill.StudsOffset = Vector3.new(0, 3, 0)
    bill.AlwaysOnTop = true

    local text = Instance.new("TextLabel")
    text.Parent = bill
    text.Size = UDim2.new(1,0,1,0)
    text.BackgroundTransparency = 1
    text.Text = obj.Name .. "\n[ " .. math.floor((obj.PrimaryPart.Position - player.Character.HumanoidRootPart.Position).Magnitude) .. "m ]"
    text.TextColor3 = Color3.new(1,1,1)
    text.TextStrokeTransparency = 0
    text.TextScaled = true
    text.Font = Enum.Font.GothamBold

    -- Color por raridade
    local rarity = obj.Name:lower()
    if rarity:find("mutant") then
        hl.FillColor = Color3.new(1,.2,0)
        box.Color3 = Color3.new(1,.2,0)
        text.TextColor3 = Color3.new(1,1,0)
    elseif rarity:find("legend") or rarity:find("chest") then
        hl.FillColor = Color3.new(1,1,0)
        box.Color3 = Color3.new(1,1,0)
        text.TextColor3 = Color3.new(1,0,1)
    else
        hl.FillColor = Color3.new(0,1,0)
        box.Color3 = Color3.new(0,1,0)
    end
end

local function fullESP()
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("Model") and (obj.Name:lower():find("fish") or obj.Name:lower():find("mutant") or obj.Name:lower():find("legend") or obj.Name:lower():find("chest")) then
            createFullESP(obj)
        end
    end
end

local function clearESPs()
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:FindFirstChild("PailaFullESP") then
            obj.PailaFullESP:Destroy()
        end
    end
end

local function autoSellLoop()
    pcall(function()
        local weight = player.leaderstats and (player.leaderstats:FindFirstChild("Weight") or player.leaderstats:FindFirstChild("Inventory"))
        if weight and weight.Value >= 90 then
            for _, r in pairs(remotes) do r:FireServer() end
            print("Paila vendeu full kg!")
        end
    end)
end

local function equipHarpoon()
    for _, tool in pairs(player.Backpack:GetChildren()) do
        if tool:IsA("Tool") and tool.Name:lower():find("harpoon") then
            tool.Parent = player.Character
            break
        end
    end
end

local function fastTube()
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.WalkSpeed = tubeSpeed
        player.Character.Humanoid.JumpPower = 100
    end
end

local function noFogFunc()
    game.Lighting.FogEnd = math.huge
    game.Lighting.FogStart = math.huge
    workspace.Terrain.FogEnd = math.huge
    workspace.Terrain.FogStart = math.huge
end

-- UI
local FarmTab = Window:NewTab("ðŸ¤¿ Farm ULTIMATE")
local FarmSec = FarmTab:NewSection("Fixados")

FarmSec:NewToggle
